<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Draft Posts | Blogger Manager</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <header>
    <div class="container header-flex">
      <h1>Draft Posts</h1>
      <select id="filter-select">
        <option value="all">All</option>
        <option value="recent">Recent</option>
        <option value="old">Old</option>
      </select>
      <a href="/blogs" class="btn back">← Back to Blogs</a>
      <a href="/logout" class="btn logout">Logout</a>
    </div>
  </header>

  <main class="container">
    <% if(posts.length === 0) { %>
      <p>No draft posts available.</p>
    <% } else { %>
      <ul class="posts-list">
        <% posts.forEach(post => { %>
          <li class="post-card" data-post-id="<%= post.id %>" data-post-content="<%= post.content %>">
            <% if (post.firstImage) { %>
              <img src="<%= post.firstImage %>" alt="Post image" />
            <% } else { %>
              <div class="no-image">No Image</div>
            <% } %>
            <div class="post-content">
              <h2><%= post.title %></h2>
              <div class="actions">
                <a class="btn publish" href="/publish/<%= blogId %>/<%= post.id %>">✅ Publish</a>
                <small style="display:block; font-size: 12px; color: #555; margin-top: 4px;">
                  سيتم نشر تغريدة تلقائيًا مع العنوان والرابط
                </small>
                <a class="btn delete" href="/delete/<%= blogId %>/<%= post.id %>">❌ Delete</a>
              </div>
            </div>
          </li>
        <% }) %>
      </ul>
    <% } %>
  </main>

  <script>
    document.querySelectorAll('.post-card').forEach(card => {
      const originalTitle = card.querySelector('h2').outerHTML;
      const originalActions = card.querySelector('.actions').outerHTML;
      const fullContent = card.getAttribute('data-post-content');

      function expandContent() {
        const container = card.querySelector('.post-content');
        container.innerHTML = `
          <div class="post-full-content">${fullContent}</div>
          ${originalActions}
        `;
      }

      function collapseContent() {
        const container = card.querySelector('.post-content');
        container.innerHTML = `${originalTitle}${originalActions}`;
      }

      card.addEventListener('mouseenter', expandContent);
      card.addEventListener('mouseleave', collapseContent);
      card.addEventListener('touchstart', expandContent);
      card.addEventListener('touchend', collapseContent);
    });
  </script>
</body>
</html>